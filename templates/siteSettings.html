<html>
    <head>
        <title>Server Settings</title>
        <meta charset="UTF-8">
        <link href="{{ url_for('static', filename='css/global.css') }}" type="text/css" rel="stylesheet">
        <link rel="shortcut icon" type="image/png" href="/{{data['faviconUrl']}}"/>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css">
    </head>
    <body class="{{currentTheme}}">
        <nav>
            <span id="navMain">
                <a href="{{ url_for('index') }}"><i class="fas fa-home text-icon"></i>Home</a>
                <a href="{{ url_for('boards') }}"><i class="fas fa-stream text-icon"></i>Boards</a>
                <a href="{{ url_for('help') }}"><i class="fas fa-question text-icon"></i>Help</a>
                <a href="settings"><i class="fas fa-cog text-icon"></i>Settings</a>
                <select onchange="changeTheme(this.value, {{themes}})" id="theme-select">
                    {% for theme in themes %}
                        <option id="{{themes[theme]['class']}}" value="{{themes[theme]['id']}}">{{themes[theme]['name']}}</option>
                    {% endfor %}
                </select>
            </span>
        </nav>
        <div class="box box-settings">
            <h2 class="box-header">{{data['siteName']}} Global Settings</h2>
            <div id="serverSettings" class="settings-category">
                <form action="/saveSettings" method="POST">
                    <h3>Server Settings</h3>
                    <hr>
                    <label>
                        Server Port:
                        <input type="text" name="port" id="serverPortInput" value="{{data['port']}}" required autocomplete="off"> <span class="small">Server must be restarted</span>
                    </label>
                    <label>
                        Media Location:
                        <input type="text" name="mediaLocation" id="serverMediaLocationInput" value="{{data['mediaLocation']}}" required autocomplete="off"> 
                    </label>
                    <hr>
                    <h3>Site Settings</h3>
                    <hr>
                    <label>
                        Site Name:
                        <input type="text" name="siteName" id="siteNameInput" value="{{data['siteName']}}" required autocomplete="off">
                    </label>
                    <label>
                        Logo:
                        <input type="text" name="siteLogo" id="siteLogoInput" value="{{data['logoUrl']}}" required autocomplete="off">
                    </label>
                    <label>
                        Favicon:
                        <input type="text" name="siteFavicon" id="siteFaviconInput" value="{{data['faviconUrl']}}" required autocomplete="off"> <span class="small">Must be in PNG format</span>
                    </label>
                    <label>
                        Spoiler Image:
                        <input type="text" name="spoilerImage" id="mimeFileInput" value="{{data['spoilerImage']}}" required autocomplete="off"> <span class="small"></span>
                    </label>
                    <label>
                        Banner Location:
                        <input type="text" name="bannerLocation" id="bannerLocationInput" value="{{data['bannerLocation']}}" required autocomplete="off"> <span class="small">This decides where uploaded banners will be kept</span>
                    </label>
                    <label>
                        Minimum permission level for board creation:
                        <select name="requiredRole" id="requiredRole">
                            {% for group in groups %}
                                <option value="{{group['id']}}"  {% if data['requiredRole'] == group['id'] | string %}selected{% endif %}>{{group['name']}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label>
                        Allow registrations:
                        <select name="enableRegistration" id="enableRegistration">
                            {% if data['enableRegistration'] == 'on' %}
                                <option value="on" selected>on</option>
                                <option value="off">off</option>
                            {% else %}
                                <option value="on">on</option>
                                <option value="off" selected>off</option>
                            {% endif %}
                        </select>
                    </label>
                    <label>
                        Allowed MIME types:
                        <input type="text" name="mimeTypes" id="mimeTypeInput" value="{{data['mimeTypes']}}" required autocomplete="off"> <span class="small">Seperate with ,</span>
                    </label>
                    <label>
                        Maximum files:
                        <input type="text" name="maxFiles" id="mimeFileInput" value="{{data['maxFiles']}}" required autocomplete="off">
                    </label>
                    <label>
                        Tripcode Length:
                        <input type="text" name="tripLength" id="tripLength" value="{{data['tripLength']}}" required autocomplete="off"> <span class="small">Longer tripcodes take more time to bruteforce</span>
                    </label>
                    <label>
                        Max number of threads per page:
                        <input type="text" name="pageThreads" id="pageThreads" value="{{data['pageThreads']}}" required autocomplete="off"> <span class="small">This sets how many threads to display on a board before creating a new page</span>
                    </label>
                    <p><input class="btn btn-primary" type="submit" value="save settings"></p>
                </form>
            </div>
        </div>
        <div class="box box-settings">
            <h2 class="box-header">Global Rules</h2>
            <div>
                <form action="/addRule" method="POST">
                    <input type="hidden" name="type" value="0">
                    <input type="hidden" name="board" value="NULL">
                    <input type="text" name="newRule" id="newRule" autocomplete="off">
                    <input class="btn btn-primary" type="submit" value="Add rule">
                </form>
                <ol type="1">
                    {%for rule in rules%}
                        <li>
                            <form action="/deleteRule" method="POST">
                                <input type="hidden" name="type" value="0">
                                <input type="hidden" name="board" value="NULL">
                                <input type="hidden" name="id" value="{{rule['id']}}">
                                <span>{{rule['content']}}</span>
                                <input class="btn btn-primary" type="submit" value="Delete rule">
                            </form>
                        </li>
                        <hr>
                    {%endfor%}
                </ol>
            </div>
        </div>
        <script src="{{ url_for('static', filename='js/themes.js') }}"></script>
    </body>
</html>